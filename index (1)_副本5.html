<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººç±»ç”Ÿç‰©å•å…ƒå·¥ä¸šåŒ–è§£æ„æ‰‹å†Œ | HUMAN BIO-UNIT MANUAL v2.0</title>
    <style>
        :root {
            --primary-green: #008f5d; /* ç»å…¸é‚®æ”¿ç»¿/å·¥ä¸šç»¿ */
            --dark-green: #004d32;
            --light-green: #e8f5e9;   
            --alert-red: #d32f2f;
            --warning-yellow: #fdd835;
            --tech-black: #121212;
            --paper-white: #f0f0f0;   /* ç¨å¾®å¸¦ç‚¹ç°ï¼Œåƒæ—§çº¸ */
            --border-style: 2px solid var(--primary-green);
        }

        * {
            box-sizing: border-box;
            user-select: none; 
        }

        body {
            font-family: 'Courier New', 'SimSun', 'Songti SC', monospace; /* å®‹ä½“/ç­‰å®½å­—ä½“æ··æ’ï¼Œæ›´æœ‰å¤å¤æ„Ÿ */
            background-color: var(--light-green);
            color: var(--tech-black);
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
            background-image: 
                linear-gradient(var(--primary-green) 1px, transparent 1px),
                linear-gradient(90deg, var(--primary-green) 1px, transparent 1px);
            background-size: 20px 20px; /* æ›´å¯†é›†çš„ç½‘æ ¼ */
            background-blend-mode: multiply;
        }

        /* ä¸»å®¹å™¨ï¼šæ¨¡æ‹Ÿæ¡£æ¡ˆè¢‹æˆ–æ§åˆ¶å° */
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--paper-white);
            border: 3px solid var(--tech-black);
            box-shadow: 15px 15px 0px var(--primary-green); /* ç¡¬æœ—çš„é˜´å½± */
            padding: 40px;
            position: relative;
        }

        /* è£…é¥°ï¼šå››è§’èºä¸ */
        .screw {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-size: 10px;
        }
        .tl { top: 10px; left: 10px; transform: rotate(45deg); }
        .tr { top: 10px; right: 10px; transform: rotate(15deg); }
        .bl { bottom: 10px; left: 10px; transform: rotate(90deg); }
        .br { bottom: 10px; right: 10px; transform: rotate(-30deg); }
        .screw::after { content: '-'; color: #888; }

        header {
            border-bottom: 2px dashed var(--tech-black);
            margin-bottom: 25px;
            padding-bottom: 15px;
            text-align: center;
        }

        h1 {
            font-size: 2.2rem;
            margin: 0;
            font-weight: 900;
            letter-spacing: -1px;
            text-shadow: 2px 2px 0px var(--primary-green);
        }

        .subtitle {
            font-size: 0.9rem;
            background: var(--tech-black);
            color: var(--primary-green);
            display: inline-block;
            padding: 4px 12px;
            margin-top: 10px;
            font-weight: bold;
        }

        .grid-system {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .grid-system { grid-template-columns: 1fr; }
        }

        .panel {
            border: 2px solid var(--tech-black);
            padding: 20px;
            position: relative;
            background: #fff;
        }

        .panel-label {
            position: absolute;
            top: -12px;
            left: 15px;
            background: var(--primary-green);
            color: #fff;
            padding: 2px 8px;
            font-size: 0.8rem;
            font-weight: bold;
            border: 1px solid var(--tech-black);
        }

        select, button {
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            font-family: inherit;
            border: 2px solid var(--tech-black);
            background: #fff;
            cursor: pointer;
            font-size: 1rem;
            outline: none;
        }

        select:hover { background: #e0f2f1; }

        button {
            background: var(--tech-black);
            color: var(--primary-green);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 5px 5px 0px rgba(0,0,0,0.2);
            transition: all 0.1s;
        }

        button:active {
            transform: translate(2px, 2px);
            box-shadow: 3px 3px 0px rgba(0,0,0,0.2);
        }

        /* è¾“å‡ºåŒºåŸŸï¼šè“å›¾é£æ ¼ */
        #result-area {
            background: #0d2b42; /* æ·±è“å›¾è‰² */
            color: #aeddf5;      /* è“å›¾æµ…è“å­— */
            padding: 25px;
            font-size: 0.9rem;
            line-height: 1.6;
            border: 4px double #fff;
            min-height: 400px;
            white-space: pre-wrap;
            overflow-y: auto;
            position: relative;
            font-family: 'Consolas', monospace;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        
        /* è“å›¾æ°´å° */
        #result-area::after {
            content: "CONFIDENTIAL // ç»å¯†æ¡£æ¡ˆ";
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-25deg);
            font-size: 3rem;
            color: rgba(255,255,255,0.05);
            pointer-events: none;
            border: 5px solid rgba(255,255,255,0.05);
            padding: 10px 20px;
        }

        /* å¼¹çª—æ ·å¼ */
        .popup {
            position: fixed;
            background: #fff;
            border: 3px solid #000;
            width: 320px;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.4);
            z-index: 1000;
            display: none;
            animation: popup-bounce 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popup-bounce {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .popup-header {
            background: var(--warning-yellow);
            padding: 8px 15px;
            font-weight: bold;
            border-bottom: 2px solid #000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .popup-body { padding: 20px; font-size: 0.95rem; }

        .close-x { cursor: pointer; font-family: sans-serif; font-weight: 900; }

        .warranty {
            font-size: 0.75rem;
            color: #666;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px dashed var(--tech-black);
            line-height: 1.5;
        }

    </style>
</head>
<body>

<div class="container" id="main-container">
    <div class="screw tl"></div><div class="screw tr"></div>
    <div class="screw bl"></div><div class="screw br"></div>

    <header>
        <h1>HUMAN BIO-UNIT MANUAL</h1>
        <h1>äººç±»ç”Ÿç‰©å•å…ƒå·¥ä¸šè¯´æ˜ä¹¦</h1>
        <div class="subtitle">å·¥ä¸šåŒ–è§£æ„ / å‚æ•°åŒ–é‡ç»„ / ç¤¾äº¤é™ç»´æ‰“å‡»</div>
    </header>

    <div class="grid-system">
        <div class="panel">
            <div class="panel-label">SECTION A: ç¡¬ä»¶æ¶æ„ (MBTI)</div>
            <select id="mbti-select">
                <option value="" disabled selected>-- è¯·é€‰æ‹©æ ¸å¿ƒå¤„ç†å™¨å‹å· --</option>
                <optgroup label="åˆ†æå¸ˆé›†ç¾¤ (é«˜ç®—åŠ›/ä½æƒ…å•†)">
                    <option value="INTJ">INTJ - æˆ˜ç•¥è§„åˆ’ä¸»æœº (Mark-I)</option>
                    <option value="INTP">INTP - é‡å­é€»è¾‘åŸå‹æœº (Proto-X)</option>
                    <option value="ENTJ">ENTJ - å¸å›½çº§æ‰§è¡Œå™¨ (Titan)</option>
                    <option value="ENTP">ENTP - æ··æ²Œæ…æ‹Œç«™ (Chaos-V)</option>
                </optgroup>
                <optgroup label="å¤–äº¤å®¶é›†ç¾¤ (é«˜å…±æƒ…/æ˜“è¿‡è½½)">
                    <option value="INFJ">INFJ - æ·±æ½œå£°çº³ç³»ç»Ÿ (Oracle)</option>
                    <option value="INFP">INFP - æ¢¦å¢ƒæ¸²æŸ“å¼•æ“ (Dreamscape)</option>
                    <option value="ENFJ">ENFJ - åœ£å…‰å¼•å¯¼å¡” (Beacon)</option>
                    <option value="ENFP">ENFP - å¿«ä¹ç²’å­åŠ é€Ÿå™¨ (Spark-Z)</option>
                </optgroup>
                <optgroup label="å®ˆæŠ¤è€…é›†ç¾¤ (é«˜ç¨³å®š/æ—§æ¥å£)">
                    <option value="ISTJ">ISTJ - é›¶è¯¯å·®å½’æ¡£åº“ (Archive)</option>
                    <option value="ISFJ">ISFJ - å†—ä½™å¤‡ä»½ç”µæº (Guardian)</option>
                    <option value="ESTJ">ESTJ - æ¶²å‹å†²å‹æœº (Press)</option>
                    <option value="ESFJ">ESFJ - ç¤¾åŒºæ¸©æ§ç³»ç»Ÿ (Harmonia)</option>
                </optgroup>
                <optgroup label="æ¢é™©å®¶é›†ç¾¤ (é«˜åŠ¨æ€/æ˜“çˆ†ç‚¸)">
                    <option value="ISTP">ISTP - æˆ˜æœ¯æ•…éšœæ’é™¤å™¨ (Mechanic)</option>
                    <option value="ISFP">ISFP - æ„Ÿå®˜æ³¢å½¢åˆæˆå™¨ (Aesthete)</option>
                    <option value="ESTP">ESTP - ç¡åŒ–ç”˜æ²¹æ¨è¿›å™¨ (Risk)</option>
                    <option value="ESFP">ESFP - å…¨æ¯é¢‘é—ªç¯ (Disco)</option>
                </optgroup>
            </select>
        </div>

        <div class="panel">
            <div class="panel-label">SECTION B: å›ºä»¶ä¸é¥æµ‹</div>
            <select id="gen-select">
                <option value="" disabled selected>-- è¯·é€‰æ‹©å‡ºå‚æ‰¹æ¬¡ --</option>
                <option value="Boomer">1946-1964 (è€å¼å›ºä»¶: æˆ¿äº§ç‰ˆ)</option>
                <option value="GenX">1965-1980 (éšå½¢å›ºä»¶: ç‹¬ç«‹ç‰ˆ)</option>
                <option value="Millennial">1981-1996 (ç„¦è™‘å›ºä»¶: è´Ÿå€ºç‰ˆ)</option>
                <option value="GenZ" selected>1997-2012 (ç ´ç¢å›ºä»¶: å‘ç–¯ç‰ˆ)</option>
            </select>
            <select id="status-select">
                <option value="STS-01">ğŸŸ¢ çŠ¶æ€: æ­£å¸¸è¿è¡Œ (Operational)</option>
                <option value="STS-02">ğŸŸ¡ çŠ¶æ€: ç”µé‡å±æ€¥ (Low Battery)</option>
                <option value="STS-03">ğŸ”´ çŠ¶æ€: è¿‡çƒ­æ„¤æ€’ (Overheated)</option>
                <option value="STS-04">ğŸ– çŠ¶æ€: é¥¿æ€’æ¨¡å¼ (Hangry)</option>
                <option value="STS-05">ğŸ’” çŠ¶æ€: æ ¸å¿ƒç ´ç¢ (Heartbroken)</option>
                <option value="STS-10">ğŸº çŠ¶æ€: è°ƒè¯•æ¨¡å¼ (Drunk/Debug)</option>
            </select>
        </div>
    </div>

    <div style="text-align: center; margin-bottom: 25px;">
        <button onclick="startGeneration()" style="padding: 18px 50px; font-size: 1.3rem;">
            >>> ç¼–è¯‘ç”Ÿæˆè¯´æ˜ä¹¦ (COMPILE) <<<
        </button>
        <div style="font-size: 0.8rem; margin-top: 10px; color: #666;">
            *è­¦å‘Šï¼šç”Ÿæˆè¿‡ç¨‹å¯èƒ½æ³„éœ²ç”±äºç”¨æˆ·é•¿æœŸç†¬å¤œå¯¼è‡´çš„å†…å­˜æº¢å‡ºé—®é¢˜ã€‚
        </div>
    </div>

    <div class="panel" style="background: #0d2b42; padding:0; border:none;">
        <div class="panel-label" style="background: #aeddf5; color:#0d2b42; border:none; top:0; left:0;">SECTION C: æœ€ç»ˆè“å›¾è¾“å‡º</div>
        <div id="result-area">// ç³»ç»Ÿå¾…æœºä¸­...
// è¯·åœ¨ä¸Šéƒ¨è¾“å…¥å‚æ•°ä»¥åˆå§‹åŒ–äººç±»é‡æ„ç¨‹åºã€‚
// WAITING FOR INPUT STREAM...</div>
    </div>

    <div class="warranty">
        <strong>å…è´£å£°æ˜ (LEGAL DISCLAIMER):</strong><br>
        1. æœ¬è¯´æ˜ä¹¦ä»…ä¾›å‚è€ƒï¼Œä¸ä½œä¸ºé€€æ¢è´§ä¾æ®ï¼ˆé™¤éä¼´ä¾£å‘ç”Ÿä¸å¯é€†çš„â€œå‡ºè½¨â€æ•…éšœï¼‰ã€‚<br>
        2. åˆ¶é€ å•†ä¸ä¿è¯æœ¬å•å…ƒèƒ½å¤Ÿç†è§£â€œéšä¾¿â€ã€â€œéƒ½è¡Œâ€ç­‰æ¨¡ç³ŠæŒ‡ä»¤ã€‚<br>
        3. è‹¥æœ¬å•å…ƒåœ¨â€œé¥¿æ€’â€çŠ¶æ€ä¸‹å’¬äººï¼Œè¯·è‡ªè¡Œæ‰¿æ‹…ç‹‚çŠ¬ç–«è‹—è´¹ç”¨ã€‚<br>
        4. æœ€ç»ˆè§£é‡Šæƒå½’ä¸Šå¸ï¼ˆæˆ–éšæœºå®‡å®™ç†µå¢ï¼‰æ‰€æœ‰ã€‚
    </div>
</div>

<div id="popup-zone"></div>

<script>
    // === æ•°æ®åº“å®šä¹‰ (å…¨é¢æ±‰åŒ–ä¸æ‰©å±•) ===

    const hardwareDB = {
        "INTJ": { name: "æˆ˜ç•¥è§„åˆ’ä¸»æœº", role: "å¹•åé»‘æ‰‹", cpu: "Logic-Core X9", flaw: "å¯¹äººç±»æ„šè ¢è¿‡æ•", social: "ä»…é™å­¦æœ¯ç ”è®¨", voice: "å†·æ¼ å•è°ƒ", fuel: "é»‘å’–å•¡" },
        "INTP": { name: "é€»è¾‘åŸå‹æœº", role: "é”®ç›˜å“²å­¦å®¶", cpu: "Wiki-Searcher V2", flaw: "æ‰§è¡ŒåŠ›ä¸ºé›¶", social: "éœ€æå‰3å¤©é¢„çº¦", voice: "ç»å¸¸è‡ªè¨€è‡ªè¯­", fuel: "ç»´ä»–å‘½æ°´" },
        "ENTJ": { name: "å¸å›½æ‰§è¡Œå™¨", role: "éœ¸é“æ€»è£", cpu: "Dominate-Pro", flaw: "ç¼ºä¹åŒæƒ…æ¨¡å—", social: "ä»¥æ­¤ä¸ºä¸­å¿ƒæ—‹è½¬", voice: "é«˜åˆ†è´æŒ‡ä»¤", fuel: "ä¸‹å±çš„çœ¼æ³ª" },
        "ENTP": { name: "æ··æ²Œæ…æ‹Œç«™", role: "ä¸“ä¸šæ ç²¾", cpu: "Devil-Advocate", flaw: "ä¸‰åˆ†é’Ÿçƒ­åº¦", social: "æŒ‘èµ·äº‰ç«¯ä¸ºä¹", voice: "æå¿«ä¸”å¸¦å˜²è®½", fuel: "æ··ä¹±èƒ½é‡" },
        
        "INFJ": { name: "æ·±æ½œå£°çº³", role: "ç¥ç§˜å…ˆçŸ¥", cpu: "Empathy-9000", flaw: "æƒ…ç»ªå¸å°˜å™¨", social: "æåº¦æŒ‘å‰”", voice: "æ¸©å’Œä½†ç–ç¦»", fuel: "è‰æœ¬èŒ¶" },
        "INFP": { name: "æ¢¦å¢ƒå¼•æ“", role: "åœ¨é€ƒå…¬ä¸»/ç‹å­", cpu: "Cry-Baby S1", flaw: "ç»ç’ƒå¿ƒæ˜“ç¢", social: "èº²åœ¨è§’è½è§‚å¯Ÿ", voice: "çŠ¹è±«ä¸”è½»æŸ”", fuel: "å¥¶èŒ¶" },
        "ENFJ": { name: "åœ£å…‰å¼•å¯¼å¡”", role: "ä¼ é”€å¤´ç›®", cpu: "Charisma-Max", flaw: "è¿‡åº¦ç‰ºç‰²è‡ªæˆ‘", social: "å¼ºåˆ¶æ€§æ¸©æš–", voice: "å……æ»¡ç…½åŠ¨æ€§", fuel: "ä»–äººçš„èµç¾" },
        "ENFP": { name: "å¿«ä¹åŠ é€Ÿå™¨", role: "å¤šåŠ¨ç—‡é‡‘æ¯›", cpu: "Rainbow-Gen", flaw: "æ³¨æ„åŠ›ç¼ºå¤±", social: "è‡ªæ¥ç†Ÿææ€–åˆ†å­", voice: "å¿½é«˜å¿½ä½", fuel: "ç³–æœ" },

        "ISTJ": { name: "å½’æ¡£è®°å½•ä»ª", role: "è¡Œèµ°Excel", cpu: "Rule-Book V1", flaw: "æ— æ³•å˜é€š", social: "æ‹’ç»æ— æ„ä¹‰å¯’æš„", voice: "æœºæ¢°å¹³ç›´", fuel: "ç™½å¼€æ°´" },
        "ISFJ": { name: "å¤‡ç”¨ç”µæº", role: "å…¨èŒä¿å§†", cpu: "Serve-OS", flaw: "ä¸ä»…ä¸ä¼šæ‹’ç»", social: "åªå¬ä¸è¯´", voice: "å”¯å”¯è¯ºè¯º", fuel: "å‰©é¥­" },
        "ESTJ": { name: "æ¶²å‹å†²å‹æœº", role: "æ•™å¯¼ä¸»ä»»", cpu: "Control-Freak", flaw: "ä»¤äººçª’æ¯çš„æ§åˆ¶æ¬²", social: "å¿…é¡»æœä»", voice: "å’†å“®ä½“", fuel: "çº¢ç‰›" },
        "ESFJ": { name: "ç¤¾åŒºæ¸©æ§", role: "å±…å§”ä¼šå¤§å¦ˆ", cpu: "Gossip-Network", flaw: "ä¾èµ–å¤–éƒ¨è¯„ä»·", social: "å…«å¦äº¤æ¢ä¸­å¿ƒ", voice: "çƒ­æƒ…è¿‡å‰©", fuel: "å®¶å¸¸èœ" },

        "ISTP": { name: "æˆ˜æœ¯ç»ˆç«¯", role: "ä¿®ç†å·¥/æ€æ‰‹", cpu: "Fix-It-Now", flaw: "æƒ…æ„Ÿæ¨¡å—ç¼ºå¤±", social: "å·²ç¦»çº¿", voice: "çŸ­ä¿ƒ", fuel: "å•¤é…’" },
        "ISFP": { name: "æ³¢å½¢åˆæˆå™¨", role: "æµæµªè‰ºæœ¯å®¶", cpu: "Vibe-Check", flaw: "ç»å¸¸æ€§å¤±è”", social: "çœ‹å¿ƒæƒ…", voice: "æ…µæ‡’", fuel: "çº¢é…’" },
        "ESTP": { name: "æ¨è¿›å™¨", role: "æé™èµŒå¾’", cpu: "YOLO-Core", flaw: "å®Œå…¨ä¸è®¡åæœ", social: "æ´¾å¯¹ä¸­å¿ƒ", voice: "å˜ˆæ‚", fuel: "çƒˆé…’" },
        "ESFP": { name: "é¢‘é—ªç¯", role: "æˆç²¾æœ¬ç²¾", cpu: "Drama-Queen", flaw: "æ— æ³•å¿å—å¯‚é™", social: "èˆå°ä¸­å¤®", voice: "å°–å«", fuel: "é¸¡å°¾é…’" }
    };

    const firmwareDB = {
        "Boomer": { name: "æˆ˜åå©´å„¿æ½®ç‰ˆ", feature: "æ—©ç¡æ—©èµ·ï¼Œå–œçˆ±å›¤ç§¯å¡‘æ–™è¢‹", bug: "æ— æ³•ç†è§£æ‰‹æœºæ”¯ä»˜", default_app: "ç”µè§†æ–°é—»", slang: "ä¸æ”¯æŒ" },
        "GenX":   { name: "Xä¸–ä»£éšå½¢ç‰ˆ", feature: "æåº¦æ„¤ä¸–å«‰ä¿—ï¼Œæ‹’ç»è¢«å®šä¹‰", bug: "å­˜åœ¨æ„Ÿè¿‡ä½", default_app: "é‚®ä»¶å®¢æˆ·ç«¯", slang: "ä½" },
        "Millennial": { name: "åƒç¦§ä¸€ä»£ç„¦è™‘ç‰ˆ", feature: "ä¾é æ˜‚è´µçš„å’–å•¡ç»­å‘½", bug: "å¯¹ä¹°æˆ¿ç»æœ›", default_app: "å°çº¢ä¹¦/Instagram", slang: "ä¸­" },
        "GenZ":   { name: "Zä¸–ä»£å‘ç–¯ç‰ˆ", feature: "ç²¾ç¥çŠ¶æ€ç¾ä¸½ï¼Œå–œçˆ±æŠ½è±¡", bug: "æ³¨æ„åŠ›åªæœ‰8ç§’", default_app: "æŠ–éŸ³/TikTok", slang: "æé«˜ (æŠ½è±¡è¯)" }
    };

    const statusDB = {
        "STS-01": { name: "æ­£å¸¸", desc: "å„é¡¹æŒ‡æ ‡å¹³ç¨³ï¼Œé€‚åˆä¸å…¶è°ˆè®ºæ­£äº‹ã€‚", risk: "ä½" },
        "STS-02": { name: "ç”µé‡ä½", desc: "ååº”è¿Ÿé’ï¼Œé¢éƒ¨è‚Œè‚‰åƒµç¡¬ã€‚", risk: "ä¸­ (å¯èƒ½éšæ—¶ä¼‘çœ )" },
        "STS-03": { name: "è¿‡çƒ­", desc: "å¤´é¡¶å†’çƒŸï¼Œæ‹’ç»ä»»ä½•é€»è¾‘è¾“å…¥ã€‚", risk: "é«˜ (æ˜“çˆ†ç‚¸)" },
        "STS-04": { name: "é¥¿æ€’", desc: "è¡€ç³–è¿‡ä½å¯¼è‡´è¿”ç¥–ç°è±¡ï¼Œå…·æœ‰æ”»å‡»æ€§ã€‚", risk: "æé«˜ (ä¼šå’¬äºº)" },
        "STS-05": { name: "å¿ƒç¢", desc: "æ’­æ”¾æ‚²ä¼¤BGMï¼Œæ¶ˆè€—å¤§é‡çº¸å·¾ã€‚", risk: "é«˜ (æ°´æ·¹é£é™©)" },
        "STS-10": { name: "è°ƒè¯•ä¸­", desc: "é…’ç²¾å¯¼è‡´é˜²ç«å¢™å¤±æ•ˆï¼Œå¼€å§‹èƒ¡è¨€ä¹±è¯­ã€‚", risk: "ä¸å®š (å¯èƒ½è¡¨ç™½æˆ–å‘•å)" }
    };

    // === ç”Ÿæˆé€»è¾‘ ===

    function startGeneration() {
        const resultArea = document.getElementById('result-area');
        const mbti = document.getElementById('mbti-select').value;
        const gen = document.getElementById('gen-select').value;
        const sts = document.getElementById('status-select').value;

        if (!mbti || !gen) {
            alert("âš ï¸ é”™è¯¯ï¼šå‚æ•°ç¼ºå¤±\nè¯·å®Œæ•´å¡«å†™ [ç¡¬ä»¶æ¶æ„] å’Œ [å‡ºå‚æ‰¹æ¬¡] ä»¥ç»§ç»­ã€‚");
            return;
        }

        resultArea.innerHTML = "// æ­£åœ¨è¿æ¥ç”Ÿç‰©ç¥ç»ç½‘ç»œ...\n// è¯»å–æ½œæ„è¯†æ•°æ®...";
        
        setTimeout(() => {
            const finalJSON = generateDetailedJSON(mbti, gen, sts);
            typeWriterEffect(resultArea, JSON.stringify(finalJSON, null, 4));
            
            // éšæœºå¼¹çª—
            setTimeout(randomPopup, 2000);
        }, 800);
    }

    function generateDetailedJSON(mbtiCode, genCode, statusCode) {
        const hw = hardwareDB[mbtiCode];
        const fw = firmwareDB[genCode];
        const st = statusDB[statusCode];

        // éšæœºç”Ÿæˆä¸€äº›æ›´è¯¦ç»†çš„æ•°æ®
        const socialBattery = statusCode === 'STS-02' ? 5 : Math.floor(Math.random() * 80) + 10;
        const stressLevel = statusCode === 'STS-03' ? 99 : Math.floor(Math.random() * 50);
        
        return {
            "äº§å“è¯†åˆ«ç  (ID)": `HUMAN-${mbtiCode}-${genCode.toUpperCase()}-V4.2`,
            "åŸºç¡€è§„æ ¼ (Meta Data)": {
                "å‹å·åç§°": `${hw.name} (${fw.name})`,
                "æ ¸å¿ƒå¤„ç†å™¨": hw.cpu,
                "åˆ¶é€ å¹´ä»½": fw.feature.split('ï¼Œ')[0], // æˆªå–ä¸€æ®µæè¿°
                "å½“å‰è¿è¡ŒçŠ¶æ€": st.name
            },
            "æ ¸å¿ƒå‚æ•° (Core Metrics)": {
                "é€»è¾‘è¿ç®—èƒ½åŠ›": ["INTJ", "INTP", "ENTJ", "ISTJ", "ESTJ"].includes(mbtiCode) ? "â˜…â˜…â˜…â˜…â˜…" : "â˜…â˜…â˜†â˜†â˜†",
                "æƒ…æ„Ÿå¤„ç†å¸¦å®½": ["INFJ", "INFP", "ENFJ", "ESFJ", "ISFP"].includes(mbtiCode) ? "æå®½ (æ˜“æº¢å‡º)" : "æçª„ (å•çº¿ç¨‹)",
                "ç¤¾äº¤ç”µæ± å®¹é‡": socialBattery + "%",
                "å‹åŠ›é˜ˆå€¼è­¦æŠ¥": stressLevel > 80 ? "!!! ä¸´ç•Œå€¼ !!!" : "å®‰å…¨èŒƒå›´å†…"
            },
            "èƒ½æºä¸é©±åŠ¨ (Energy & Drive)": {
                "æ¨èç‡ƒæ–™": hw.fuel,
                "é©±åŠ¨æ¨¡å¼": ["ENTJ", "ESTJ", "ESTP"].includes(mbtiCode) ? "é‡å¿ƒé©±åŠ¨ (Ambition)" : "ç„¦è™‘é©±åŠ¨ (Anxiety)",
                "èƒ½è€—ç­‰çº§": ["ENFP", "ENTP", "ESFP"].includes(mbtiCode) ? "é«˜è€—èƒ½ (éœ€é¢‘ç¹å…³æ³¨)" : "ä½åŠŸè€— (èŠ‚èƒ½ç¯ä¿)"
            },
            "äº¤äº’åè®® (Interaction Protocol)": {
                "è¯­éŸ³è¾“å‡ºé£æ ¼": hw.voice,
                "ç½‘ç»œç”¨è¯­å…¼å®¹æ€§": fw.slang,
                "é»˜è®¤APP": fw.default_app,
                "å¦‚ä½•ä»¥æ­¤äººå¼€æœº": statusCode === 'STS-04' ? "ç¦æ­¢å¼€æœºï¼Œè¯·å…ˆæŠ•é£Ÿ" : "è½»æ‹èƒŒéƒ¨æˆ–å‘é€çº¢åŒ…"
            },
            "æ•…éšœæ’é™¤ (Troubleshooting)": {
                "å·²çŸ¥Bug": hw.flaw,
                "ç³»ç»Ÿå´©æºƒè¯±å› ": fw.bug,
                "å½“å‰é£é™©æç¤º": st.risk,
                "ç´§æ€¥é‡å¯æ–¹å¼": "é•¿æŒ‰ [è½¬è´¦] æŒ‰é’® 5 ç§’é’Ÿ"
            },
            "æ‰©å±•æ¨¡å— (Extensions)": {
                "æ‹çˆ±æ¨¡å¼": "æœªå®‰è£…æˆ–æ–‡ä»¶æŸå",
                "å·¥ä½œæ¨¡å¼": "å¼ºåˆ¶è¿è¡Œä¸­ (æ— æ³•å…³é—­)",
                "çŒ«/ç‹—å…¼å®¹æ€§": "æä½³ (ä¼˜äºå¯¹äººç±»çš„å…¼å®¹æ€§)"
            },
            "ä¿ä¿®æ¡æ¬¾ (Warranty)": "ä¸€ç»å”®å‡ºï¼ˆç¡®ç«‹å…³ç³»ï¼‰ï¼Œæ¦‚ä¸é€€æ¢ã€‚äººä¸ºæŸåï¼ˆå¦‚PUAï¼‰å°†å¯¼è‡´ä¿ä¿®å¤±æ•ˆã€‚"
        };
    }

    // === æ‰“å­—æœºç‰¹æ•ˆ ===
    function typeWriterEffect(element, text) {
        element.innerHTML = "";
        let i = 0;
        const speed = 2; // æ‰“å­—é€Ÿåº¦ï¼Œè¶Šå°è¶Šå¿«
        
        function type() {
            if (i < text.length) {
                element.innerHTML += text.charAt(i);
                i++;
                // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
                element.scrollTop = element.scrollHeight;
                if (i % 20 === 0) setTimeout(type, speed); // ç¨å¾®åˆ†æ®µä¸€ä¸‹é˜²æ­¢æµè§ˆå™¨å¡é¡¿
                else setTimeout(type, 0); 
            }
        }
        type();
    }

    // === ææ€ªå¼¹çª—é€»è¾‘ ===
    const popupTexts = [
        { title: "âš ï¸ è­¦å‘Šï¼šç¤¾äº¤é…é¢ä¸è¶³", msg: "ä»Šæ—¥ç¤¾äº¤ä½™é¢å·²è€—å°½ã€‚è¯·ç«‹å³åˆ‡æ¢è‡³é£è¡Œæ¨¡å¼æˆ–èº²å…¥å•æ‰€å›è¡€ã€‚" },
        { title: "ğŸ’» ç³»ç»Ÿæ›´æ–°æç¤º", msg: "æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬è¡¥ä¸ 'æ¥å—å¹³å‡¡ v2.0'ã€‚æ˜¯å¦å®‰è£…ï¼Ÿ(æ³¨æ„ï¼šå®‰è£…åå°†æ°¸ä¹…åˆ é™¤ 'ä¸€å¤œæš´å¯Œ' å¹»æƒ³æ¨¡å—)" },
        { title: "â˜• å’–å•¡å› ä¸¥é‡çŸ­ç¼º", msg: "è¡€æ¶²ä¸­å’–å•¡å› å«é‡ä½äº 0.05%ã€‚å¤§è„‘æ­£åœ¨æ‰§è¡Œé™é¢‘æ“ä½œ..." },
        { title: "ğŸ’” æƒ…æ„Ÿæ¨¡å—é”™è¯¯", msg: "æ— æ³•è§£æå¯¹æ–¹çš„è¨€å¤–ä¹‹æ„ã€‚å»ºè®®å›å¤ï¼š'å¤šå–çƒ­æ°´' ä»¥è§„é¿é£é™©ã€‚" },
        { title: "ğŸš« 404 Not Found", msg: "æ‚¨è¯•å›¾å¯»æ‰¾çš„ [å­˜æ¬¾] ä¸å­˜åœ¨ã€‚è¯·ç»§ç»­æ¬ç –ã€‚" },
        { title: "ğŸ‘€ éšç§è­¦å‘Š", msg: "æ£€æµ‹åˆ°æœ‰äººæ­£åœ¨æ³¨è§†å±å¹•ã€‚æ˜¯å¦ç«‹å³åˆ‡æ¢åˆ° [Excelè¡¨æ ¼] ä¼ªè£…å·¥ä½œï¼Ÿ" }
    ];

    function randomPopup() {
        const zone = document.getElementById('popup-zone');
        const data = popupTexts[Math.floor(Math.random() * popupTexts.length)];
        
        const div = document.createElement('div');
        div.className = 'popup';
        // éšæœºä½ç½®
        const top = Math.random() * (window.innerHeight - 200) + 50;
        const left = Math.random() * (window.innerWidth - 350) + 20;
        div.style.top = top + 'px';
        div.style.left = left + 'px';

        div.innerHTML = `
            <div class="popup-header">
                <span>${data.title}</span>
                <span class="close-x" onclick="this.parentElement.parentElement.remove()">Ã—</span>
            </div>
            <div class="popup-body">
                ${data.msg}
                <div style="margin-top:15px; text-align:right;">
                    <button style="width:auto; padding:5px 15px; font-size:0.8rem;" onclick="this.parentElement.parentElement.remove()">ç¡®è®¤ (SIGH)</button>
                </div>
            </div>
        `;

        zone.appendChild(div);
        div.style.display = 'block';

        // 10ç§’åè‡ªåŠ¨æ¶ˆå¤±
        setTimeout(() => div.remove(), 10000);
    }
</script>

</body>
</html>